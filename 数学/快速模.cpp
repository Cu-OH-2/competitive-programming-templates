/*******************************************************************
* 时间复杂度：O(1)
* 说明：x 不能超过 O(p^2)，保险起见最好最后再模一次
*******************************************************************/
struct BarretReduction
{
    ll m, p;
    void init(int pp)
    {
        m = ((__int128)1 << 64) / pp;
        p = pp;
    }
    ll operator()(ll x) { return x - ((__int128(x) * m) >> 64) * p; }
} br;